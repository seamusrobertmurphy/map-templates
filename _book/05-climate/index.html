<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>5&nbsp; Climate – Mapping Templates</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../06-demography/index.html" rel="next">
<link href="../04-topography/index.html" rel="prev">
<link href="../assets/PNG/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dcd723bd3e2d8e65306aa707aebc1039.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1d21bedf07900770407f0b9fb3305521.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="../site_libs/htmltools-fill/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets/htmlwidgets.js"></script><script src="../site_libs/jquery/jquery-3.6.0.min.js"></script><link href="../site_libs/leaflet/leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet/leaflet.js"></script><link href="../site_libs/leafletfix/leafletfix.css" rel="stylesheet">
<script src="../site_libs/proj4/proj4.min.js"></script><script src="../site_libs/Proj4Leaflet/proj4leaflet.js"></script><link href="../site_libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet-binding/leaflet.js"></script><script src="../site_libs/leaflet-providers/leaflet-providers_2.0.0.js"></script><script src="../site_libs/leaflet-providers-plugin/leaflet-providers-plugin.js"></script>
<meta property="og:title" content="5&nbsp; Climate – Mapping Templates">
<meta property="og:description" content="">
<meta property="og:site_name" content="Mapping Templates">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../05-climate/index.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Climate</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Mapping Templates</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/seamusrobertmurphy/map-templates" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-field-sites/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Field Sites</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-watersheds/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Watersheds</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-streams/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Streams</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-topography/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Topography</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-climate/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Climate</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06-demography/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Demography</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99"><h2 id="toc-title"><strong>On this page</strong></h2>
   
  <ul>
<li><a href="#import-aoi-data" id="toc-import-aoi-data" class="nav-link active" data-scroll-target="#import-aoi-data"><span class="header-section-number">5.1</span> 1. Import AOI Data</a></li>
  <li><a href="#import-dem-data" id="toc-import-dem-data" class="nav-link" data-scroll-target="#import-dem-data"><span class="header-section-number">5.2</span> 2. Import DEM Data</a></li>
  <li><a href="#import-climate-data" id="toc-import-climate-data" class="nav-link" data-scroll-target="#import-climate-data"><span class="header-section-number">5.3</span> 3. Import Climate Data</a></li>
  <li>
<a href="#render-maps" id="toc-render-maps" class="nav-link" data-scroll-target="#render-maps"><span class="header-section-number">5.4</span> 4. Render Maps</a>
  <ul class="collapse">
<li><a href="#runtime-log" id="toc-runtime-log" class="nav-link" data-scroll-target="#runtime-log">Runtime Log</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/seamusrobertmurphy/map-templates/edit/main/05-climate/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/seamusrobertmurphy/map-templates/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Climate</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="cell">
<style type="text/css">
div.column {
    display: inline-block;
    vertical-align: top;
    width: 50%;
}

#TOC::before {
  content: "";
  display: block;
  height:200px;
  width: 200px;
  background-image: url('https://raw.githubusercontent.com/seamusrobertmurphy/forest-fire-risk-cffdrs/main/assets/PNG/temp.png');
  background-size: contain;
  background-position: 50% 50%;
  padding-top: 80px !important;
  background-repeat: no-repeat;
}
</style>
</div>
<section id="import-aoi-data" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="import-aoi-data">
<span class="header-section-number">5.1</span> 1. Import AOI Data</h2>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span></span>
<span>  url      <span class="op">=</span> <span class="st">"https://data.hydrosheds.org/file/HydroBASINS/customized_with_lakes/hybas_lake_na_lev06_v1c.zip"</span>,</span>
<span>  destfile <span class="op">=</span> <span class="st">"../assets/SHP/watersheds_na_l6.zip"</span>,</span>
<span>  mode     <span class="op">=</span> <span class="st">"wb"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html">unzip</a></span><span class="op">(</span></span>
<span>  zipfile <span class="op">=</span> <span class="st">"../assets/SHP/watersheds_na_l6.zip"</span>,</span>
<span>  exdir   <span class="op">=</span> <span class="st">"../assets/SHP/"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">xy</span>         <span class="op">=</span> <span class="st">"49.95,-119.43"</span></span>
<span><span class="va">watersheds</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"../assets/SHP/watersheds_na_l6/hybas_lake_na_lev06_v1c.shp"</span><span class="op">)</span></span>
<span><span class="va">aoi_xy</span>     <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"../assets/SHP/aoi_xy.shp"</span><span class="op">)</span></span>
<span><span class="va">aoi</span>        <span class="op">=</span> <span class="va">watersheds</span> <span class="op">|&gt;</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html">st_intersection</a></span><span class="op">(</span><span class="va">aoi_xy</span><span class="op">)</span> </span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html">st_write</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="st">"../assets/SHP/aoi_watershed.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tmap_mode.html">tmap_mode</a></span><span class="op">(</span><span class="st">"view"</span><span class="op">)</span></span>
<span><span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span> <span class="op">+</span> <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"purple"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_scalebar.html">tm_scalebar</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span><span class="op">)</span>, text.size <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_title.html">tm_title</a></span><span class="op">(</span><span class="st">"AOI Waterhsed"</span>, size<span class="op">=</span><span class="fl">.8</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p></p>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-7acaaa9768a56c0eb6e4" style="width:100%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-7acaaa9768a56c0eb6e4">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"attributionControl":true},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addLayersControl","args":[[],"aoi",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery",null,"Esri.WorldImagery",{"minZoom":0,"maxZoom":18,"maxNativeZoom":17,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addPolygons","args":[[[[{"lng":[-119.4438771565755,-119.4477895100911,-119.4574459499783,-119.4583333333333,-119.4579800075955,-119.4538133409288,-119.4545199924045,-119.4579800075955,-119.4586866590711,-119.4621466742621,-119.4628533257378,-119.4663133409288,-119.4670199924045,-119.4704800075955,-119.4711866590712,-119.4746466742621,-119.4753533257378,-119.4788133409288,-119.4791666666666,-119.4813771565755,-119.4852895100911,-119.5174133300781,-119.5227895100911,-119.5299133300781,-119.5352895100911,-119.5605438232422,-119.5644561767578,-119.5824276394314,-119.5842137654622,-119.5925167507595,-119.5975688265593,-119.5906295776367,-119.5792922973633,-119.5755233764648,-119.5716781616211,-119.5779485866053,-119.5801467895508,-119.5809783935547,-119.5864410400391,-119.5915222167969,-119.5958374837547,-119.5985641479492,-119.6039357330791,-119.6035430908203,-119.6,-119.6003533257378,-119.6038133409288,-119.6041666666666,-119.6083333333333,-119.6078755528689,-119.6093368530273,-119.6101634310628,-119.6102676391602,-119.6155166625977,-119.6238250732422,-119.6262671169314,-119.6328048706055,-119.6321182250977,-119.6243438720703,-119.6211090087891,-119.6210238668848,-119.6182690731168,-119.621787516276,-119.6272482977973,-119.631085035536,-119.6551074557834,-119.6615007188585,-119.666056145562,-119.6666666666666,-119.6855438232422,-119.6936228434244,-119.7049133300781,-119.7102895100911,-119.7158157348633,-119.7172339545356,-119.7327660454644,-119.7339006212022,-119.7254577636719,-119.7301862928602,-119.7625,-119.7621466742621,-119.7583472357856,-119.7666527642144,-119.7628533257378,-119.7621466742621,-119.7683788723416,-119.7774244520399,-119.7892422146267,-119.8065911187066,-119.8121419270833,-119.8128533257378,-119.8392130533854,-119.8440911187066,-119.8559088812934,-119.8857577853732,-119.8892422146267,-119.8940911187066,-119.91007554796,-119.91837955051,-119.9225755479601,-119.925,-119.9253533257378,-119.9288133409288,-119.9291666666666,-119.9326721191406,-119.9333333333333,-119.9399244520399,-119.94757554796,-119.9524244520399,-119.9559088812934,-119.9600492689344,-119.9704755995008,-119.9711866590712,-119.9746466742621,-119.9753533257378,-119.9850448608398,-119.9875,-119.9869327121311,-119.9839006212022,-119.9827660454644,-119.9797339545356,-119.9785993787977,-119.9754618326823,-119.9827660454644,-119.9841842651367,-119.9897104899088,-119.9936228434245,-120.0022104899088,-120.0269561767578,-120.0313771565755,-120.0352895100911,-120.05,-120.0541666666666,-120.0535112169054,-120.0497275458442,-120.0298795912001,-120.0291666666666,-120.0283157348633,-120.025,-120.0166666666667,-120.0159986707899,-120.0061731974284,-119.9969397650824,-119.9952156914605,-119.9913767496745,-119.9825966729058,-119.9729934692383,-119.9686731974284,-119.9604934692383,-119.953697543674,-119.9469921535916,-119.9452156914605,-119.9413867526584,-119.9328642103407,-119.9262125651041,-119.9243823581271,-119.9214509752061,-119.9202156914605,-119.916552734375,-119.910339864095,-119.9063268025716,-119.9020065307617,-119.8969921535916,-119.8958333333333,-119.8892422146267,-119.8854166666666,-119.88087955051,-119.8684088812934,-119.8649244520399,-119.8600755479601,-119.8565911187066,-119.84757554796,-119.8399244520399,-119.8333333333333,-119.825,-119.8244327121311,-119.8204374525282,-119.8144561767578,-119.8105438232422,-119.8061228434245,-119.8022104899088,-119.7811228434245,-119.7772104899088,-119.7716842651367,-119.7708333333333,-119.77119140625,-119.7767422146267,-119.7899537828233,-119.7961866590712,-119.795477464464,-119.7899244520399,-119.7875,-119.7770316229926,-119.7729683770074,-119.7633265177409,-119.7618572658962,-119.758976067437,-119.7576905992296,-119.746476067437,-119.7449578179253,-119.7395807902018,-119.7340538872613,-119.7333333333333,-119.7355438232422,-119.7406989203559,-119.74251759847,-119.7458333333333,-119.7465998331705,-119.7509407891167,-119.756085035536,-119.7772482977973,-119.781085035536,-119.7916666666666,-119.7910993787977,-119.7880672878689,-119.786932712131,-119.7952236599392,-119.7964006212022,-119.7922339545356,-119.7916666666666,-119.7642422146267,-119.7607577853732,-119.75,-119.7458333333333,-119.7461866590712,-119.7538133409288,-119.7541666666666,-119.75,-119.7392422146267,-119.7354166666666,-119.7315911187066,-119.7274537828233,-119.7232577853732,-119.71912044949,-119.7149244520399,-119.6899522569444,-119.6836873372396,-119.6829800075955,-119.6795199924045,-119.6791666666666,-119.6824824015299,-119.6833333333333,-119.6809088812934,-119.675353664822,-119.675,-119.6666666666666,-119.6660490247938,-119.6631176418728,-119.6615137736002,-119.646635945638,-119.6450651380751,-119.6383002387153,-119.6368823581271,-119.6452156914605,-119.6458333333333,-119.671066792806,-119.6673472086588,-119.6659235636393,-119.6604027642144,-119.6479305691189,-119.614569430881,-119.6104305691189,-119.5895694308811,-119.5812639024522,-119.5708333333333,-119.5673278808594,-119.5660107082791,-119.5605438232422,-119.5561228434244,-119.5480438232422,-119.5436228434245,-119.5397104899088,-119.5269561767578,-119.5230438232422,-119.5019561767578,-119.4980438232422,-119.4727895100911,-119.4688771565755,-119.4519561767578,-119.4480438232422,-119.44251759847,-119.4407533433702,-119.425,-119.4184088812934,-119.4149244520399,-119.4059088812934,-119.4024244520399,-119.3934088812934,-119.3899244520399,-119.3875,-119.36007554796,-119.35587955051,-119.3392422146267,-119.3357577853732,-119.3041666666666,-119.2965725368923,-119.2951905992296,-119.2923094007704,-119.2916666666666,-119.2925274319119,-119.2963024563259,-119.3020065307617,-119.3129691229926,-119.3186731974284,-119.3284510294596,-119.3297843085395,-119.3256176418728,-119.3243823581271,-119.3172843085395,-119.3160490247938,-119.3047843085395,-119.3035490247938,-119.2922843085395,-119.2910490247938,-119.2881176418728,-119.2868823581271,-119.2838948567708,-119.2868823581271,-119.2881176418728,-119.2961300320095,-119.3,-119.2996466742621,-119.2961866590712,-119.2954800075955,-119.2920199924045,-119.2916666666666,-119.28507554796,-119.2815911187066,-119.2791666666666,-119.2788133409288,-119.2711866590711,-119.2708333333333,-119.2625,-119.2616490681966,-119.2561228434244,-119.2522104899088,-119.2466842651367,-119.2458333333333,-119.2392422146267,-119.2357577853732,-119.2333333333333,-119.2258456759982,-119.217271762424,-119.2157591078016,-119.2089872572157,-119.2076709323459,-119.1992419772678,-119.1922073364258,-119.1873475816515,-119.1827282375759,-119.1840664333767,-119.1894939846462,-119.193839348687,-119.1978273179796,-119.2032591078016,-119.204771762424,-119.2119666205512,-119.2089384290907,-119.2077282375759,-119.2006050957574,-119.1993136935764,-119.193839348687,-119.1833333333333,-119.1833333333333,-119.1798043145074,-119.1785993787977,-119.1714006212022,-119.1702660454644,-119.1589006212022,-119.1577660454644,-119.136932712131,-119.1380672878689,-119.1422339545356,-119.1410993787977,-119.1380672878689,-119.1366126166449,-119.125887383355,-119.1240322536892,-119.1188771565755,-119.1166666666666,-119.1059088812934,-119.1024244520399,-119.08507554796,-119.0815911187066,-119.0708333333333,-119.0666666666666,-119.0625,-119.0625,-119.0625,-119.0625,-119.0603525797526,-119.043814086914,-119.0132663302951,-119.0120025634765,-119.017297024197,-119.0160363091363,-119.0118696424696,-119.0136990017361,-119.018814086914,-119.0228525797526,-119.025,-119.0313771565755,-119.0352895100911,-119.0410288492838,-119.0422339545356,-119.0660993787977,-119.0672339545356,-119.0702660454644,-119.0714006212022,-119.074432712131,-119.0755672878689,-119.0660837809244,-119.0593400743272,-119.0577660454644,-119.0619327121311,-119.0630672878689,-119.0660993787977,-119.0672339545356,-119.0712293836805,-119.0772104899088,-119.0852895100911,-119.0882466634114,-119.0936228434245,-119.1090799967448,-119.1144561767578,-119.1241126166449,-119.1258968777126,-119.1384372287326,-119.1477895100911,-119.1549133300781,-119.1602895100911,-119.1647104899088,-119.1740802341037,-119.1755672878689,-119.1827660454644,-119.1833333333333,-119.1467081705729,-119.1456319173177,-119.149432712131,-119.1507083468967,-119.1576875474718,-119.1714006212022,-119.1702660454644,-119.1660993787977,-119.1679163614909,-119.1727895100911,-119.1783157348632,-119.1791666666666,-119.1642422146267,-119.1607577853732,-119.1517422146267,-119.1433824327257,-119.1184088812934,-119.1149244520399,-119.1017422146267,-119.0975463867187,-119.0934088812934,-119.0857577853732,-119.07257554796,-119.06875,-119.0642130533854,-119.0309088812934,-119.0267130533854,-119.02257554796,-119.0190911187066,-118.99757554796,-118.9940911187066,-118.9833333333333,-118.97257554796,-118.9690911187066,-118.96007554796,-118.9565911187066,-118.9517422146267,-118.9482577853732,-118.9458333333333,-118.9450981987847,-118.934100680881,-118.9174723307291,-118.9156670464409,-118.8811730278862,-118.877160305447,-118.8717597113715,-118.8699069552951,-118.8645063612196,-118.8604936387804,-118.8341820610894,-118.8297841389974,-118.8282402886284,-118.8228396945529,-118.8171359592014,-118.8145063612196,-118.8104936387803,-118.8,-118.8003533257378,-118.8121466742621,-118.8128533257378,-118.8166680230034,-118.8107577853732,-118.8083333333333,-118.807482571072,-118.8005984836154,-118.8,-118.8008507622612,-118.8041666666666,-118.807482571072,-118.8091840955946,-118.8147104899088,-118.8186228434244,-118.8208333333333,-118.8274244520399,-118.8309088812934,-118.8440911187066,-118.8479166666666,-118.8517422146267,-118.8625,-118.8632198757595,-118.8771348741319,-118.8811984592014,-118.8896348741319,-118.8936984592014,-118.9000233968099,-118.9048095703125,-118.9035237630208,-118.8993570963541,-118.9019877115885,-118.9061984592014,-118.9104682074652,-118.9163448757595,-118.9188015407986,-118.922865125868,-118.9354682074652,-118.9413448757595,-118.9479682074653,-118.9520317925347,-118.9620744493272,-118.9701904296875,-118.9715521918402,-118.9791900634765,-118.9826904296875,-118.9833333333333,-118.9854556613498,-118.9937110053168,-118.9979556613498,-119.0062110053168,-119.0187889946831,-119.0353776719835,-119.0396223280165,-119.0490837944878,-119.0506554497613,-119.057677883572,-119.0589887830946,-119.0674343532986,-119.1116333007812,-119.1131554497613,-119.1255835639106,-119.1375,-119.1604934692382,-119.1686731974284,-119.1713024563259,-119.1779541015625,-119.1797843085395,-119.1836007012261,-119.1715869479709,-119.1702156914605,-119.1744384765625,-119.1714509752061,-119.1705446324914,-119.1702156914605,-119.1687417452814,-119.1672843085395,-119.1666666666666,-119.1676344129774,-119.1729166666666,-119.1784200032552,-119.1796960626537,-119.1798221246228,-119.1855438232422,-119.1909200032552,-119.2147104899088,-119.2186228434245,-119.2282792833116,-119.2300864325629,-119.2394561767578,-119.2480438232422,-119.2519561767578,-119.2583333333333,-119.2625,-119.2630672878689,-119.2672339545356,-119.2660993787977,-119.2630672878689,-119.261932712131,-119.2577660454644,-119.2589006212022,-119.2660993787977,-119.2673278808593,-119.2708333333333,-119.2774244520399,-119.28125,-119.28507554796,-119.2982577853732,-119.3017422146267,-119.3100462171766,-119.3142422146267,-119.3333333333333,-119.3341842651367,-119.3397104899088,-119.3436228434245,-119.3522104899088,-119.3602895100911,-119.3647104899088,-119.3686228434244,-119.3708333333333,-119.3857577853732,-119.3892422146267,-119.4190911187066,-119.42257554796,-119.4333333333333,-119.4342207166883,-119.4438771565755],"lat":[49.66609937879777,49.66306728786896,49.66179148356123,49.65833333333337,49.65174221462676,49.64754621717668,49.6350755479601,49.63159111870663,49.62674221462677,49.6232577853733,49.61424221462677,49.61075778537329,49.60590888129344,49.60242445203996,49.5975755479601,49.59409111870663,49.58090888129343,49.57742445203996,49.57500000000003,49.57556728786896,49.57859937879778,49.57973395453562,49.57556728786896,49.57443271213111,49.57859937879778,49.57973395453562,49.58276604546444,49.58397098117408,49.59093051486548,49.59223395453562,49.58802068853494,49.57530975341797,49.56628799438477,49.55474853515625,49.52903366088867,49.52109394709114,49.518310546875,49.50621795654297,49.50341033935547,49.50607299804688,49.50591871439616,49.50582122802734,49.5040408442874,49.49674258761939,49.49583333333337,49.49340888129343,49.48992445203996,49.48750000000003,49.48750000000003,49.50273501166587,49.50225067138672,49.51303344961106,49.5143928527832,49.53009033203125,49.54222106933594,49.54564864467547,49.55482482910156,49.55983352661133,49.5655517578125,49.56660079956055,49.56671556414049,49.5704288091319,49.57424333360463,49.5755294799805,49.57863718668623,49.57969614664717,49.57451799180776,49.57593688964847,49.58333333333336,49.58276604546444,49.57556728786896,49.57443271213111,49.57859937879778,49.58001759847009,49.58554382324222,49.60195617675785,49.609270562066,49.61874576144751,49.62441575792104,49.62500000000003,49.62742445203996,49.63125067816843,49.63958265516496,49.64340888129343,49.65588107638892,49.66214430067278,49.66285332573788,49.67464667426218,49.67535332573788,49.68087649875221,49.6857577853733,49.71214243570967,49.71285332573788,49.72464667426219,49.72535332573788,49.72881334092885,49.72951999240455,49.74548000759552,49.74618665907121,49.74201999240454,49.7416666666667,49.74409111870663,49.7475755479601,49.75833333333337,49.75923292371965,49.7666666666667,49.76631334092885,49.75868665907122,49.75798000759552,49.75451999240455,49.75381334092885,49.76421152750655,49.76909111870663,49.7725755479601,49.77742445203997,49.78714226616757,49.78750000000003,49.78971048990888,49.79362284342452,49.80221048990889,49.80612284342451,49.81054382324222,49.8145921495226,49.82278951009118,49.82831573486332,49.82973395453563,49.83276604546445,49.83390062120229,49.85776604546444,49.85890062120229,49.86193271213111,49.86250000000003,49.86250000000003,49.87295566134986,49.87837253146705,49.87992621527781,49.89583333333335,49.89914906819665,49.90000000000003,49.90000000000003,49.91585422092017,49.91728430853953,49.92529669867625,49.93132680257165,49.93658209906688,49.93811764187286,49.92978430853953,49.92854902479387,49.9214509752062,49.92021569146054,49.9251139322917,49.93132680257165,49.93656853569882,49.93811764187286,49.93325873480906,49.93966013590498,49.94367319742842,49.94799346923831,49.95300784640845,49.95478430853953,49.95771569146054,49.9589509752062,49.9626139322917,49.96666666666668,49.96701999240454,49.97081875271271,49.96631334092886,49.96701999240454,49.97048000759552,49.97118665907121,49.97464667426219,49.97535332573788,49.98298000759552,49.98333333333337,49.98333333333337,49.98971048990889,49.9948655870226,49.99640062120229,49.99943271213111,50.00056728786896,50.00359937879778,50.00473395453562,50.00776604546444,50.00918426513675,50.01250000000004,50.0149568345812,50.02048000759552,50.02118818495012,50.02745225694448,50.03578813340933,50.04131334092885,50.0416666666667,50.04230940077043,50.04519059922963,50.04665985107425,50.05630171034075,50.06036495632599,50.06880171034075,50.08119828965933,50.09608357747399,50.09227108425568,50.09659949408641,50.10833333333336,50.10890062120227,50.11289605034725,50.11998257107207,50.12083333333335,50.12408786349828,50.12552964952259,50.12136298285592,50.12030368381078,50.11719631618926,50.11666666666669,50.12721048990888,50.1311228434245,50.14461839463978,50.14674614800349,50.17574666341148,50.1811228434245,50.20000000000002,50.20035332573786,50.20381334092884,50.20416666666669,50.20416666666669,50.24825778537328,50.25590888129342,50.26250000000002,50.26250000000002,50.26285332573786,50.26665208604603,50.26285332573786,50.26214667426218,50.26631334092884,50.26701999240453,50.26285332573786,50.26214667426218,50.26838039822051,50.29825778537329,50.30174221462676,50.30416666666669,50.30501742892798,50.30833333333335,50.3086866590712,50.31421407063804,50.33750000000002,50.33750000000002,50.3479936387804,50.35200636121964,50.35761617024742,50.35906846788197,50.36986151801217,50.3717959933811,50.37990349663631,50.38950636121964,50.40833333333335,50.40908237033423,50.4145694308811,50.43638916015627,50.43818054199221,50.44931945800784,50.45068054199221,50.4534861246745,50.45484720865888,50.46181945800784,50.46250000000002,50.46160040961374,50.44679328070749,50.44223395453561,50.44109937879777,50.43390062120228,50.43276604546443,50.42973395453561,50.42859937879776,50.42556728786894,50.4244327121311,50.42140062120228,50.42026604546443,50.41723395453561,50.41609937879777,50.41306728786895,50.41164923773874,50.40477430555558,50.40416666666669,50.40451999240454,50.4079800075955,50.4086866590712,50.41214667426217,50.41285332573787,50.41631334092884,50.41666666666669,50.41631334092884,50.41214667426217,50.41285332573787,50.41631334092884,50.41666666666669,50.41744147406686,50.4354682074653,50.43953179253474,50.45416666666669,50.45717739529082,50.45895080566409,50.45478413899742,50.45354919433596,50.45771586100263,50.45913899739585,50.47546929253475,50.48117302788631,50.4854936387804,50.49367302788631,50.51466030544707,50.52700636121964,50.53132697211374,50.54367302788631,50.5479936387804,50.55200636121964,50.56466030544707,50.56875000000002,50.57283969455298,50.58966030544707,50.59889356825089,50.60000000000002,50.60242445203995,50.60590888129342,50.61909111870662,50.6225755479601,50.63333333333335,50.6336866590712,50.63714667426218,50.63750000000002,50.63992445203996,50.64757554796009,50.65000000000003,50.65000000000003,50.64668409559464,50.64526604546443,50.64223395453561,50.64081590440541,50.63750000000002,50.63714667426218,50.6336866590712,50.63333333333335,50.63261854383683,50.62300618489586,50.61757405598961,50.61568840874568,50.58830193413631,50.5870561387804,50.59227159288197,50.59010450575089,50.58387383355037,50.57165832519534,50.56727159288197,50.56606174045141,50.5631049262153,50.56159261067711,50.55616048177086,50.54792412651912,50.54383951822919,50.53949381510419,50.53133951822919,50.51336263020836,50.50893825954864,50.50833333333335,50.49166666666669,50.49076097276478,50.47278951009117,50.46471048990887,50.4561228434245,50.44387715657555,50.43528951009117,50.41352539062503,50.39778951009117,50.39241333007815,50.38528951009117,50.38137715657555,50.37570834689672,50.37429165310332,50.36706271701391,50.36306728786894,50.36250000000002,50.36285332573787,50.36631334092884,50.36701999240454,50.37048000759551,50.37083333333336,50.37083333333336,50.37083333333336,50.36666666666669,50.35833333333336,50.35416666666669,50.35353630913631,50.3381303575304,50.33681572808162,50.32441914876304,50.31706305609811,50.31035257975262,50.30456305609811,50.30087076822919,50.29936964246964,50.29646369086374,50.29583333333336,50.29526604546443,50.29223395453561,50.29076097276478,50.27278951009117,50.24804382324221,50.22278951009117,50.21887715657554,50.21028951009117,50.20637715657554,50.20322943793405,50.19258626302086,50.19085557725697,50.18675333658856,50.18137715657554,50.17695617675783,50.17304382324221,50.1686228434245,50.16346774631079,50.1619327121311,50.15473395453561,50.15359937879776,50.15776604546443,50.15890062120228,50.15473395453561,50.15345831976998,50.1465053982205,50.14526604546443,50.15359937879776,50.15473395453561,50.15056728786895,50.14943271213109,50.1410837809245,50.13528951009117,50.12721048990888,50.12083333333335,50.12024875217016,50.1154479980469,50.11054382324221,50.10088738335506,50.09909634060332,50.0843214246962,50.07278951009116,50.06741333007815,50.06267734103734,50.05890062120228,50.05748257107207,50.05416666666669,50.05381334092885,50.05035332573788,50.04964667426218,50.04131334092885,50.04201999240455,50.04548000759552,50.04618665907122,50.05035332573788,50.04964667426218,50.04201999240455,50.04131334092885,50.03751458062069,50.04201999240455,50.04131334092885,50.03714667426219,50.03785332573788,50.04131334092885,50.04201999240455,50.04548000759552,50.04583333333337,50.04618665907122,50.04964667426218,50.05035332573788,50.05381334092885,50.05451999240455,50.05798000759552,50.05833333333335,50.05080329047313,50.04104902479387,50.04238043891063,50.05478430853953,50.05354902479387,50.05061764187286,50.04907362196184,50.04259304470489,50.04104902479387,50.03811764187287,50.03682556152347,50.03132680257165,50.02592637803823,50.02438235812721,50.02021569146054,50.0214509752062,50.02438235812721,50.02500000000003,50.01840888129344,50.00659111870663,50.00174221462677,49.99790072970924,49.99201999240455,49.9916666666667,49.98835093180342,49.98658430311418,49.9666666666667,49.96335093180342,49.96250000000003,49.96164906819665,49.95501759847009,49.95359937879778,49.95056728786896,49.95000000000003,49.95035332573788,49.95381334092885,49.95451999240455,49.95831875271271,49.95451999240455,49.9541666666667,49.94244333902999,49.94102393256297,49.93814273410376,49.9368572658963,49.9339760674371,49.9320717705621,49.92532179090716,49.91869828965932,49.91282179090715,49.90779503716367,49.90480940077043,49.90352393256297,49.8993572658963,49.90064273410377,49.90352393256297,49.90480940077043,49.9089760674371,49.90769059922963,49.90480940077043,49.90327911376956,49.89380171034075,49.87603810628259,49.87373843722877,49.86880171034075,49.8666666666667,49.86601121690541,49.85898878309465,49.85767788357208,49.85065544976132,49.84934455023875,49.83398878309465,49.83267788357208,49.82462921142582,49.81454433865021,49.80628899468319,49.80204433865021,49.79236111111114,49.79101121690542,49.81045566134986,49.82425299750437,49.82500000000003,49.8243823581272,49.81728430853953,49.81604902479387,49.82090793185768,49.81450653076175,49.80928192138676,49.80753343370229,49.79536421034074,49.78958333333337,49.78549346923831,49.77620936517919,49.77283986409508,49.77082203262835,49.76882680257165,49.76250000000003,49.75872921413849,49.75463545057512,49.75890062120229,49.75869738950409,49.75867731223489,49.75776604546444,49.75359937879777,49.75473395453562,49.75776604546444,49.75904184977217,49.76608378092451,49.77443271213111,49.77556728786896,49.77859937879778,49.7791666666667,49.7791666666667,49.77695617675784,49.77157999674483,49.75612284342451,49.75221048990889,49.74362284342451,49.73824666341149,49.72278951009118,49.71471048990889,49.70089959038631,49.70000000000003,49.69964667426218,49.69584791395403,49.69964667426218,49.70035332573788,49.70381334092885,49.70451999240455,49.70035332573788,49.70000000000003,49.69668426513675,49.69526604546444,49.69223395453562,49.69109937879777,49.68390062120229,49.68276604546444,49.67973395453562,49.6791666666667,49.67881334092885,49.67535332573788,49.67464667426218,49.67118665907121,49.67083333333336,49.6673751831055,49.66609937879777]}]]],"X1","aoi",{"interactive":false,"className":"","pane":"tmap401","stroke":true,"color":"#A020F0","weight":2,"opacity":1,"fill":true,"fillColor":"#00000000","fillOpacity":1,"dashArray":"","smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomright"}]}],"fitBounds":[49.46425000000004,-120.07925,50.67325000000002,-118.7749166666666,[]],"limits":{"lat":[49.48750000000003,50.65000000000003],"lng":[-120.0541666666666,-118.8]}},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n\t\t\t\t\t\tfunction(el, x) {\n\t\t\t\t\t\t\tvar tldiv = el.getElementsByClassName(\"leaflet-top leaflet-left\")[0];\n\t\t\t\t\t\t\tvar titlediv = document.createElement('div');\n\t\t\t\t\t\t\ttitlediv.className = \"info legend leaflet-control\";\n\t\t\t\t\t\t\ttitlediv.innerHTML = \"<b>AOI Waterhsed<\/b>\";\n\t\t\t\t\t\t\ttldiv.insertBefore(titlediv, tldiv.childNodes[0]);\n\t\t\t\t\t\t}).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
</section><section id="import-dem-data" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="import-dem-data">
<span class="header-section-number">5.2</span> 2. Import DEM Data</h2>
<p><strong>Note:</strong> More efficient conditioning algorithms available with <code>RichDEM</code> library <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># z = 12: 1-Arc Second </span></span>
<span><span class="co"># z = 11: 3-Arc Second </span></span>
<span><span class="co"># z = 10: 5-Arc Second </span></span>
<span><span class="co">#Download and process DEM </span></span>
<span><span class="va">dem</span> <span class="op">=</span> <span class="fu">elevatr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/elevatr/man/get_elev_raster.html">get_elev_raster</a></span><span class="op">(</span><span class="va">aoi</span>, z<span class="op">=</span><span class="fl">10</span>,clip<span class="op">=</span><span class="st">"locations"</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html">rast</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crop.html">crop</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html">vect</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">flowdem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flowdem/man/breach.html">breach</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">flowdem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flowdem/man/fill.html">fill</a></span><span class="op">(</span>epsilon<span class="op">=</span><span class="cn">T</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html">writeRaster</a></span><span class="op">(</span><span class="va">dem</span>, <span class="st">"../assets/TIF/dem_5arc_condt_kelowna.tif"</span>, overwrite<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="import-climate-data" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="import-climate-data">
<span class="header-section-number">5.3</span> 3. Import Climate Data</h2>
<p>Climate data, a fundamental input for wildfire weather calculations, is sourced from Environment and Climate Change Canada using the <code>weathercan</code> package. This approach replaces the manual data sourcing from platforms with reproducible, verifiable solution. The workflow begins by searching for all weather stations within a specified radius of the AOI. Hourly data for these stations is downloaded for the defined date range and then aggregated to a single mean value for each station for the target period. The cleaned, point-based spatial data is converted into continuous raster layers for each input variable, which are derived using Inverse Distance Weighting (IDW) method via a <code>gstat</code> model and the <code><a href="https://rspatial.github.io/terra/reference/interpolate.html">terra::interpolate</a></code> function. The resulting outputs of mean daily temperature, precipitation, relative humidity, and wind speed are then masked to the AOI and saved for use in the next stages of the analysis.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Search weather stations</span></span>
<span><span class="va">stations_100km</span> <span class="op">=</span> <span class="fu">weathercan</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/weathercan/reference/stations_search.html">stations_search</a></span><span class="op">(</span></span>
<span>  coords  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">49.95</span>,<span class="op">-</span><span class="fl">119.43</span><span class="op">)</span>, </span>
<span>  interval<span class="op">=</span> <span class="st">"day"</span>,</span>
<span>  dist    <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parse by station</span></span>
<span><span class="va">stations_ids_unique</span> <span class="op">&lt;-</span> <span class="va">stations_100km</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">station_id</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download data for all selected stations</span></span>
<span><span class="va">climate_tbl</span> <span class="op">&lt;-</span> <span class="fu">weathercan</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/weathercan/reference/weather_dl.html">weather_dl</a></span><span class="op">(</span></span>
<span>  station_ids <span class="op">=</span> <span class="va">stations_ids_unique</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"2021-06-01"</span>,</span>
<span>  end <span class="op">=</span> <span class="st">"2021-10-01"</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"hour"</span><span class="op">)</span> <span class="co"># relative humidity in hourly only</span></span>
<span></span>
<span><span class="co"># Aggregate by station</span></span>
<span><span class="va">aggregated_data</span> <span class="op">&lt;-</span> <span class="va">climate_tbl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">station_id</span>, <span class="va">lat</span>, <span class="va">lon</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean_temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">temp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_prec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">prec_amt</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_rh   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rel_hum</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_ws   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">wind_spd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to spatial and filter missing stations</span></span>
<span><span class="va">climate_sf</span> <span class="op">&lt;-</span> <span class="va">aggregated_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.nan</a></span><span class="op">(</span><span class="va">mean_temp</span><span class="op">)</span>,</span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.nan</a></span><span class="op">(</span><span class="va">mean_prec</span><span class="op">)</span>,</span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.nan</a></span><span class="op">(</span><span class="va">mean_rh</span><span class="op">)</span>,</span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.nan</a></span><span class="op">(</span><span class="va">mean_ws</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span></span>
<span>    coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span>,</span>
<span>    crs <span class="op">=</span> <span class="fl">4326</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="st">"EPSG:3857"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Derive raster template to interpolate on top of</span></span>
<span><span class="va">raster_template</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html">rast</a></span><span class="op">(</span><span class="st">"../assets/TIF/elevation.tif"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Derive function to handle `sf` weather station data</span></span>
<span><span class="va">interpolate_stations</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">x</span>, <span class="va">crs</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">x</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="va">crs</span><span class="op">)</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">v</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span><span class="co"># Create Inverse Distance Weighting models using gstat.pkg</span></span>
<span><span class="va">temp_idw</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">mean_temp</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>  locations <span class="op">=</span> <span class="va">climate_sf</span>,</span>
<span>  nmax <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>idp <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">prec_idw</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">mean_prec</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>  locations <span class="op">=</span> <span class="va">climate_sf</span>,</span>
<span>  nmax <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>idp <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">rh_idw</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">mean_rh</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>  locations <span class="op">=</span> <span class="va">climate_sf</span>,</span>
<span>  nmax <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>idp <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">ws_idw</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">mean_ws</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>  locations <span class="op">=</span> <span class="va">climate_sf</span>,</span>
<span>  nmax <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>idp <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Spatially interpolate using terra.pkg</span></span>
<span><span class="va">temp_rast</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/interpolate.html">interpolate</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">raster_template</span>,</span>
<span>  model <span class="op">=</span> <span class="va">temp_idw</span>,</span>
<span>  fun <span class="op">=</span> <span class="va">interpolate_stations</span>,</span>
<span>  crs <span class="op">=</span> <span class="st">"EPSG:3857"</span>,</span>
<span>  debug.level <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">prec_rast</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/interpolate.html">interpolate</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">raster_template</span>,</span>
<span>  model <span class="op">=</span> <span class="va">prec_idw</span>,</span>
<span>  fun <span class="op">=</span> <span class="va">interpolate_stations</span>,</span>
<span>  crs <span class="op">=</span> <span class="st">"EPSG:3857"</span>,</span>
<span>  debug.level <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rh_rast</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/interpolate.html">interpolate</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">raster_template</span>,</span>
<span>  model <span class="op">=</span> <span class="va">rh_idw</span>,</span>
<span>  fun <span class="op">=</span> <span class="va">interpolate_stations</span>,</span>
<span>  crs <span class="op">=</span> <span class="st">"EPSG:3857"</span>,</span>
<span>  debug.level <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ws_rast</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/interpolate.html">interpolate</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">raster_template</span>,</span>
<span>  model <span class="op">=</span> <span class="va">ws_idw</span>,</span>
<span>  fun <span class="op">=</span> <span class="va">interpolate_stations</span>,</span>
<span>  crs <span class="op">=</span> <span class="st">"EPSG:3857"</span>,</span>
<span>  debug.level <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tidy, save, and visualize</span></span>
<span><span class="va">temp</span>    <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mask.html">mask</a></span><span class="op">(</span><span class="va">temp_rast</span>, <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html">vect</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="st">"EPSG:3857"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prec</span>    <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mask.html">mask</a></span><span class="op">(</span><span class="va">prec_rast</span>, <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html">vect</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="st">"EPSG:3857"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rh</span>      <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mask.html">mask</a></span><span class="op">(</span><span class="va">rh_rast</span>, <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html">vect</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="st">"EPSG:3857"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ws</span>      <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mask.html">mask</a></span><span class="op">(</span><span class="va">ws_rast</span>, <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html">vect</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="st">"EPSG:3857"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html">writeRaster</a></span><span class="op">(</span><span class="va">temp</span>, <span class="st">"../assets/TIF/temp.tif"</span>, overwrite<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html">writeRaster</a></span><span class="op">(</span><span class="va">prec</span>, <span class="st">"../assets/TIF/prec.tif"</span>, overwrite<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html">writeRaster</a></span><span class="op">(</span><span class="va">rh</span>, <span class="st">"../assets/TIF/rh.tif"</span>, overwrite<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html">writeRaster</a></span><span class="op">(</span><span class="va">ws</span>, <span class="st">"../assets/TIF/ws.tif"</span>, overwrite<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="render-maps" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="render-maps">
<span class="header-section-number">5.4</span> 4. Render Maps</h2>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tmap_mode.html">tmap_mode</a></span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span><span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">+</span> <span class="fu">tm_raster</span><span class="op">(</span>style<span class="op">=</span> <span class="st">"cont"</span>, </span>
<span>  title<span class="op">=</span><span class="st">"Mean Daily Temperature (°C 2m AGL)"</span>, palette<span class="op">=</span><span class="st">"Oranges"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span><span class="op">+</span> <span class="fu">tm_borders</span><span class="op">(</span>col<span class="op">=</span><span class="st">"purple"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_compass.html">tm_compass</a></span><span class="op">(</span>color.dark<span class="op">=</span><span class="st">"gray60"</span>,text.color<span class="op">=</span><span class="st">"gray60"</span>,position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RIGHT"</span>,<span class="st">"top"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_grid.html">tm_graticules</a></span><span class="op">(</span>lines<span class="op">=</span><span class="cn">T</span>,labels.rot<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">90</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_scale_bar.html">tm_scale_bar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>, position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span><span class="op">)</span>, text.size <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tm1</span></span>
<span></span>
<span><span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">prec</span><span class="op">)</span><span class="op">+</span> <span class="fu">tm_raster</span><span class="op">(</span>style<span class="op">=</span> <span class="st">"cont"</span>, </span>
<span>  title<span class="op">=</span><span class="st">"Mean Daily Precipitation (mm^3/day)"</span>, palette<span class="op">=</span><span class="st">"Oranges"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span><span class="op">+</span> <span class="fu">tm_borders</span><span class="op">(</span>col<span class="op">=</span><span class="st">"purple"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_compass.html">tm_compass</a></span><span class="op">(</span>color.dark<span class="op">=</span><span class="st">"gray60"</span>,text.color<span class="op">=</span><span class="st">"gray60"</span>,position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RIGHT"</span>,<span class="st">"top"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_grid.html">tm_graticules</a></span><span class="op">(</span>lines<span class="op">=</span><span class="cn">T</span>,labels.rot<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">90</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_scale_bar.html">tm_scale_bar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>, position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span><span class="op">)</span>, text.size <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tm2</span></span>
<span>  </span>
<span><span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">rh</span><span class="op">)</span><span class="op">+</span> <span class="fu">tm_raster</span><span class="op">(</span>style<span class="op">=</span> <span class="st">"cont"</span>, </span>
<span>  title<span class="op">=</span><span class="st">"Relative Humidity (NCDC 2m AGL)"</span>, palette<span class="op">=</span><span class="st">"Oranges"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span><span class="op">+</span> <span class="fu">tm_borders</span><span class="op">(</span>col<span class="op">=</span><span class="st">"purple"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_compass.html">tm_compass</a></span><span class="op">(</span>color.dark<span class="op">=</span><span class="st">"gray60"</span>,text.color<span class="op">=</span><span class="st">"gray60"</span>,position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RIGHT"</span>,<span class="st">"top"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_grid.html">tm_graticules</a></span><span class="op">(</span>lines<span class="op">=</span><span class="cn">T</span>,labels.rot<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">90</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_scale_bar.html">tm_scale_bar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>, position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span><span class="op">)</span>, text.size <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tm3</span></span>
<span></span>
<span><span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ws</span><span class="op">)</span><span class="op">+</span> <span class="fu">tm_raster</span><span class="op">(</span>style<span class="op">=</span> <span class="st">"cont"</span>, </span>
<span>  title<span class="op">=</span><span class="st">"Wind Speed (m/s 10m AGL)"</span>, palette<span class="op">=</span><span class="st">"Oranges"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span><span class="op">+</span> <span class="fu">tm_borders</span><span class="op">(</span>col<span class="op">=</span><span class="st">"purple"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_compass.html">tm_compass</a></span><span class="op">(</span>color.dark<span class="op">=</span><span class="st">"gray60"</span>,text.color<span class="op">=</span><span class="st">"gray60"</span>,position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RIGHT"</span>,<span class="st">"top"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_grid.html">tm_graticules</a></span><span class="op">(</span>lines<span class="op">=</span><span class="cn">T</span>,labels.rot<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">90</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_scale_bar.html">tm_scale_bar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>, position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span><span class="op">)</span>, text.size <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tm4</span></span>
<span></span>
<span><span class="fu">tmap</span><span class="fu">::</span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tmap_arrange.html">tmap_arrange</a></span><span class="op">(</span><span class="va">tm1</span>, <span class="va">tm2</span>, <span class="va">tm3</span>, <span class="va">tm4</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 49%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="https://raw.githubusercontent.com/seamusrobertmurphy/forest-fire-risk-cffdrs/main/assets/PNG/temp.png" class="img-fluid" width="345"></td>
<td style="text-align: center;"><img src="https://raw.githubusercontent.com/seamusrobertmurphy/forest-fire-risk-cffdrs/main/assets/PNG/rh.png" class="img-fluid" width="345"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://raw.githubusercontent.com/seamusrobertmurphy/forest-fire-risk-cffdrs/main/assets/PNG/prec.png" class="img-fluid" width="345"></td>
<td style="text-align: center;"><img src="https://raw.githubusercontent.com/seamusrobertmurphy/forest-fire-risk-cffdrs/main/assets/PNG/ws.png" class="img-fluid" width="345"></td>
</tr>
</tbody>
</table>
<section id="runtime-log" class="level3"><h3 class="anchored" data-anchor-id="runtime-log">Runtime Log</h3>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://sessioninfo.r-lib.org/reference/session_info.html">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## ─ Session info ───────────────────────────────────────────</span></span>
<span><span class="co">##  setting  value</span></span>
<span><span class="co">##  version  R version 4.3.0 (2023-04-21)</span></span>
<span><span class="co">##  os       macOS 15.7.1</span></span>
<span><span class="co">##  system   aarch64, darwin20</span></span>
<span><span class="co">##  ui       X11</span></span>
<span><span class="co">##  language (EN)</span></span>
<span><span class="co">##  collate  en_US.UTF-8</span></span>
<span><span class="co">##  ctype    en_US.UTF-8</span></span>
<span><span class="co">##  tz       America/Vancouver</span></span>
<span><span class="co">##  date     2025-11-01</span></span>
<span><span class="co">##  pandoc   3.8 @ /opt/local/bin/ (via rmarkdown)</span></span>
<span><span class="co">##  quarto   1.7.33 @ /usr/local/bin/quarto</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ─ Packages ───────────────────────────────────────────────</span></span>
<span><span class="co">##  package           * version   date (UTC) lib source</span></span>
<span><span class="co">##  abind               1.4-8     2024-09-12 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  backports           1.5.0     2024-05-23 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  base64enc           0.1-3     2015-07-28 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  bibtex            * 0.5.1     2023-01-26 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  brew                1.0-10    2023-12-16 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  bslib               0.9.0     2025-01-30 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  cachem              1.1.0     2024-05-16 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  cartogram           0.3.0     2023-05-26 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  cffdrs            * 1.9.2     2025-08-22 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  chromote          * 0.5.1     2025-04-24 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  class               7.3-23    2025-01-01 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  classInt            0.4-11    2025-01-08 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  cli                 3.6.5     2025-04-23 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  codetools           0.2-20    2024-03-31 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">##  colorspace          2.1-1     2024-07-26 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  cols4all          * 0.9       2025-08-28 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  coro                1.1.0     2024-11-05 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  crosstalk           1.2.2     2025-08-26 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  curl              * 7.0.0     2025-08-19 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  data.table          1.17.8    2025-07-10 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  DBI                 1.2.3     2024-06-02 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  deldir              2.0-4     2024-02-28 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  devtools          * 2.4.5     2022-10-11 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  dichromat           2.0-0.1   2022-05-02 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  digest              0.6.37    2024-08-19 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  doParallel          1.0.17    2022-02-07 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  dplyr             * 1.1.4     2023-11-17 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">##  e1071               1.7-16    2024-09-16 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  elevatr           * 0.99.0    2023-09-12 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  ellipsis            0.3.2     2021-04-29 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  ellmer            * 0.2.1     2025-06-03 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  evaluate            1.0.5     2025-08-27 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  farver              2.1.2     2024-05-13 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  fastmap             1.2.0     2024-05-15 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  FNN                 1.1.4.1   2024-09-22 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  foreach             1.5.2     2022-02-02 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  fs                  1.6.6     2025-04-12 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  generics            0.1.4     2025-05-09 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  geonetwork        * 0.6.0     2025-07-23 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  ggplot2           * 3.5.2     2025-04-09 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  glue                1.8.0     2024-09-30 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  gstat             * 2.1-4     2025-07-10 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  gtable              0.3.6     2024-10-25 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  hexbin              1.28.5    2024-11-13 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  htmltools         * 0.5.8.1   2024-04-04 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  htmlwidgets         1.6.4     2023-12-06 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">##  httpuv              1.6.16    2025-04-16 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  httr2             * 1.2.1     2025-07-22 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  igraph              2.1.4     2025-01-23 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  interp              1.1-6     2024-01-26 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  intervals           0.15.5    2024-08-23 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  iterators           1.0.14    2022-02-05 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  janitor           * 2.2.1     2024-12-22 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  jpeg                0.1-11    2025-03-21 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  jquerylib           0.1.4     2021-04-26 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  jsonlite            2.0.0     2025-03-27 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  kableExtra        * 1.4.0     2024-01-24 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">##  KernSmooth          2.23-26   2025-01-01 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  knitr             * 1.50      2025-03-16 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  later               1.4.4     2025-08-27 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  lattice           * 0.22-7    2025-04-02 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  latticeExtra        0.6-30    2022-07-04 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  leafem              0.2.5     2025-08-28 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  leaflegend          1.2.1     2024-05-09 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  leaflet             2.2.2     2024-03-26 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">##  leaflet.providers   2.0.0     2023-10-17 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  leafpop             0.1.0     2021-05-22 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  leafsync            0.1.0     2019-03-05 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  lifecycle           1.0.4     2023-11-07 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  logger              0.4.0     2024-10-22 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  lubridate           1.9.4     2024-12-08 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  lutz              * 0.3.2     2023-10-17 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  lwgeom              0.2-14    2024-02-21 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">##  magrittr            2.0.4     2025-09-12 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  mapedit           * 0.7.0     2025-04-20 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  maptiles            0.10.0    2025-05-07 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  mapview           * 2.11.2    2023-10-13 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">##  memoise             2.0.1     2021-11-26 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  microbenchmark      1.5.0     2024-09-04 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  mime                0.13      2025-03-17 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  miniUI              0.1.2     2025-04-17 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  ncdf4             * 1.24      2025-03-25 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  OpenStreetMap     * 0.4.0     2023-10-12 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">##  openxlsx          * 4.2.8     2025-01-25 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  osmdata           * 0.2.5     2023-08-14 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  packcircles         0.3.7     2024-11-21 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  pacman              0.5.1     2019-03-11 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  pandoc            * 0.2.0     2023-08-24 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  pandocfilters     * 0.1-6     2022-08-11 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  pillar              1.11.0    2025-07-04 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  pkgbuild            1.4.8     2025-05-26 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  pkgconfig           2.0.3     2019-09-22 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  pkgload             1.4.0     2024-06-28 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  plyr                1.8.9     2023-10-02 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  png                 0.1-8     2022-11-29 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  processx            3.8.6     2025-02-21 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  profvis             0.4.0     2024-09-20 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  progressr           0.15.1    2024-11-22 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  PROJ              * 0.6.0     2025-04-03 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  proj4               1.0-15    2025-03-21 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  promises            1.3.3     2025-05-29 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  proxy               0.4-27    2022-06-09 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  ps                  1.9.1     2025-04-12 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  purrr               1.1.0     2025-07-10 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  R6                  2.6.1     2025-02-15 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  rappdirs            0.3.3     2021-01-31 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  raster            * 3.6-32    2025-03-28 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  rasterVis         * 0.51.6    2023-11-01 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  RColorBrewer        1.1-3     2022-04-03 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  Rcpp                1.1.0     2025-07-02 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  remotes             2.5.0     2024-03-17 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  renv              * 1.1.5     2025-07-24 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  reproj            * 0.7.0     2024-06-11 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  rJava               1.0-11    2024-01-26 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  rlang               1.1.6     2025-04-11 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  rmapshaper        * 0.5.0     2023-04-11 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  rmarkdown         * 2.29      2024-11-04 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  rstudioapi          0.17.1    2024-10-22 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  s2                  1.1.9     2025-05-23 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  S7                  0.2.0     2024-11-07 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  sass                0.4.10    2025-04-11 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  satellite           1.0.6     2025-08-21 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  scales              1.4.0     2025-04-24 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  sessioninfo         1.2.3     2025-02-05 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  sf                * 1.0-22    2025-08-25 [1] Github (r-spatial/sf@3660edf)</span></span>
<span><span class="co">##  shiny               1.11.1    2025-07-03 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  shinyWidgets        0.9.0     2025-02-21 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  snakecase           0.11.1    2023-08-27 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  sp                * 2.2-0     2025-02-01 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  spacesXYZ           1.6-0     2025-06-06 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  spacetime           1.3-3     2025-02-13 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  stars               0.6-8     2025-02-01 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  stringi             1.8.7     2025-03-27 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  stringr             1.5.2     2025-09-08 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  svglite             2.2.1     2025-05-12 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  systemfonts         1.2.3     2025-04-30 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  terra             * 1.8-60    2025-07-21 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  textshaping         1.0.3     2025-09-02 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  tibble              3.3.0     2025-06-08 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  tidyselect          1.2.1     2024-03-11 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">##  timechange          0.3.0     2024-01-18 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  tinytex           * 0.57      2025-04-15 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  tmap              * 4.1       2025-05-12 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  tmap.cartogram    * 0.2       2025-05-14 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  tmap.glyphs       * 0.1       2025-05-30 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  tmap.networks     * 0.1       2025-05-30 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  tmaptools         * 3.2       2025-01-13 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  units               0.8-7     2025-03-11 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  urlchecker          1.0.1     2021-11-30 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  useful            * 1.2.6.1   2023-10-24 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">##  usethis           * 3.1.0     2024-11-26 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  uuid                1.2-1     2024-07-29 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  V8                  6.0.4     2025-06-04 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  vctrs               0.6.5     2023-12-01 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  viridisLite         0.4.2     2023-05-02 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  weathercan        * 0.7.5     2025-08-26 [1] https://ropensci.r-universe.dev (R 4.3.0)</span></span>
<span><span class="co">##  websocket           1.4.4     2025-04-10 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  withr               3.0.2     2024-10-28 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  wk                  0.9.4     2024-10-11 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  xfun                0.53      2025-08-19 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  XML                 3.99-0.18 2025-01-01 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  xml2                1.4.0     2025-08-20 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">##  xtable              1.8-4     2019-04-21 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  xts                 0.14.1    2024-10-15 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  yaml                2.3.10    2024-07-26 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  zip                 2.3.3     2025-05-13 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">##  zoo                 1.8-14    2025-04-10 [1] CRAN (R 4.3.3)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  [1] /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library</span></span>
<span><span class="co">##  * ── Packages attached to the search path.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ──────────────────────────────────────────────────────────</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<!-- -->

</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Breach-fill algorithm by Lindsay’s paper (2016) “Efficient hybrid breaching-filling sink removal methods for flow path enforcement in digital elevation models: Efficient Hybrid Sink Removal Methods for Flow Path Enforcement: (Hydrological Processes 30, 846–857. doi:10.1002/hyp.10648) -&gt; <code>flowdem::comp_breach_lindsay2016(dem)</code><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/seamusrobertmurphy\.quarto\.pub\/map-templates");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../04-topography/index.html" class="pagination-link" aria-label="Topography">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Topography</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../06-demography/index.html" class="pagination-link" aria-label="Demography">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Demography</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb6" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Climate"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-expand: true </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "**On this page**"</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: pygments</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: article</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 60</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("easypackages")</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"devtools"</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"bibtex"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cffdrs"</span>, <span class="st">"curl"</span>, <span class="st">"cols4all"</span>, <span class="st">"chromote"</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dplyr"</span>,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"elevatr"</span>, <span class="st">"ellmer"</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"gstat"</span>, <span class="st">"geonetwork"</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"htmltools"</span>, <span class="st">"httr2"</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"janitor"</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kableExtra"</span>, <span class="st">"knitr"</span>,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lutz"</span>, </span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"mapedit"</span>,<span class="st">"mapview"</span>, </span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ncdf4"</span>,</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">"openxlsx"</span>,<span class="st">"OpenStreetMap"</span>, <span class="st">"osmdata"</span>,</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pandoc"</span>, <span class="st">"pandocfilters"</span>, <span class="st">"PROJ"</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">"raster"</span>, <span class="st">"rasterVis"</span>, <span class="st">"reproj"</span>, <span class="st">"rmapshaper"</span>, <span class="st">"renv"</span>, <span class="st">"rmarkdown"</span>,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sf"</span>,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tinytex"</span>, <span class="st">"tmap"</span>, <span class="st">"tmaptools"</span>, <span class="st">"terra"</span>, <span class="st">"tmap.networks"</span>, <span class="st">"tmap.glyphs"</span>, <span class="st">"tmap.cartogram"</span>,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">"useful"</span>, <span class="st">"usethis"</span>, </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  <span class="st">"weathercan"</span>)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo    =</span> T, </span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">error   =</span> F, </span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> F, </span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning =</span> F,</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment =</span> <span class="cn">NA</span>, </span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">tidy.opts =</span> <span class="fu">list</span>(</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">width.cutoff =</span> <span class="dv">60</span>)</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">htmltools.dir.version =</span> F, </span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">htmltools.preserve.raw =</span> F)</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tmap_options</span>(</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">component.autoscale=</span>F,</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">max.raster =</span> <span class="fu">c</span>(<span class="at">plot=</span><span class="dv">8000000</span>, <span class="at">view=</span><span class="dv">10000000</span>)</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a><span class="fu">mapviewOptions</span>(<span class="at">fgb =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">sf_use_s2</span>(<span class="at">use_s2 =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{css, echo=FALSE, class.source = 'foldable'}</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>div<span class="op">.</span><span class="fu">column</span> <span class="op">{</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>    display<span class="op">:</span> inline<span class="op">-</span>block<span class="op">;</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>    vertical<span class="op">-</span>align<span class="op">:</span> top<span class="op">;</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>    width<span class="op">:</span> <span class="dv">50</span><span class="op">%;</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>#TOC<span class="op">::</span>before <span class="op">{</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>  content<span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>  display<span class="op">:</span> block<span class="op">;</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>  height<span class="op">:</span><span class="dv">200</span>px<span class="op">;</span></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>  width<span class="op">:</span> <span class="dv">200</span>px<span class="op">;</span></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>  background<span class="op">-</span>image<span class="op">:</span> <span class="fu">url</span><span class="op">(</span>'https<span class="op">:</span><span class="co">//raw.githubusercontent.com/seamusrobertmurphy/forest-fire-risk-cffdrs/main/assets/PNG/temp.png');</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>  background<span class="op">-</span>size<span class="op">:</span> contain<span class="op">;</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>  background<span class="op">-</span>position<span class="op">:</span> <span class="dv">50</span><span class="op">%</span> <span class="dv">50</span><span class="op">%;</span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>  padding<span class="op">-</span>top<span class="op">:</span> <span class="dv">80</span>px <span class="op">!</span>important<span class="op">;</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>  background<span class="op">-</span>repeat<span class="op">:</span> no<span class="op">-</span>repeat<span class="op">;</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. Import AOI Data</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r aoi-import}</span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">url      =</span> <span class="st">"https://data.hydrosheds.org/file/HydroBASINS/customized_with_lakes/hybas_lake_na_lev06_v1c.zip"</span>,</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="st">"../assets/SHP/watersheds_na_l6.zip"</span>,</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode     =</span> <span class="st">"wb"</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(</span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">zipfile =</span> <span class="st">"../assets/SHP/watersheds_na_l6.zip"</span>,</span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">exdir   =</span> <span class="st">"../assets/SHP/"</span></span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a>xy         <span class="ot">=</span> <span class="st">"49.95,-119.43"</span></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>watersheds <span class="ot">=</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">"../assets/SHP/watersheds_na_l6/hybas_lake_na_lev06_v1c.shp"</span>)</span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>aoi_xy     <span class="ot">=</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">"../assets/SHP/aoi_xy.shp"</span>)</span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>aoi        <span class="ot">=</span> watersheds <span class="sc">|&gt;</span> sf<span class="sc">::</span><span class="fu">st_intersection</span>(aoi_xy) </span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_write</span>(aoi, <span class="st">"../assets/SHP/aoi_watershed.shp"</span>)</span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(aoi) <span class="sc">+</span> tmap<span class="sc">::</span><span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">"purple"</span>, <span class="at">lwd=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_scalebar</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span>), <span class="at">text.size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_title</span>(<span class="st">"AOI Waterhsed"</span>, <span class="at">size=</span>.<span class="dv">8</span>) </span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>aoi <span class="ot">=</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">"../assets/SHP/aoi_watershed.shp"</span>, <span class="at">quiet=</span>T)</span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(aoi) <span class="sc">+</span> tmap<span class="sc">::</span><span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">"purple"</span>, <span class="at">lwd=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_scalebar</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span>), <span class="at">text.size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_title</span>(<span class="st">"AOI Waterhsed"</span>, <span class="at">size=</span>.<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_basemap</span>(<span class="st">"Esri.WorldImagery"</span>)</span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Import DEM Data</span></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>**Note:** More efficient conditioning algorithms available</span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>with <span class="in">`RichDEM`</span> library <span class="ot">[^1]</span></span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a><span class="co"># z = 12: 1-Arc Second </span></span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a><span class="co"># z = 11: 3-Arc Second </span></span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a><span class="co"># z = 10: 5-Arc Second </span></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a><span class="co">#Download and process DEM </span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a>dem <span class="ot">=</span> elevatr<span class="sc">::</span><span class="fu">get_elev_raster</span>(aoi, <span class="at">z=</span><span class="dv">10</span>,<span class="at">clip=</span><span class="st">"locations"</span>)<span class="sc">|&gt;</span></span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">rast</span>() <span class="sc">|&gt;</span> </span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">crop</span>(terra<span class="sc">::</span><span class="fu">vect</span>(aoi)) <span class="sc">|&gt;</span></span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a>  flowdem<span class="sc">::</span><span class="fu">breach</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a>  flowdem<span class="sc">::</span><span class="fu">fill</span>(<span class="at">epsilon=</span>T) </span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a>raster<span class="sc">::</span><span class="fu">writeRaster</span>(dem, <span class="st">"../assets/TIF/dem_5arc_condt_kelowna.tif"</span>, <span class="at">overwrite=</span>T)</span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Import Climate Data</span></span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>Climate data, a fundamental input for wildfire weather calculations, is sourced from Environment and Climate Change Canada using the <span class="in">`weathercan`</span> package. This approach replaces the manual data sourcing from platforms with reproducible, verifiable solution. The workflow begins by searching for all weather stations within a specified radius of the AOI. Hourly data for these stations is downloaded for the defined date range and then aggregated to a single mean value for each station for the target period. The cleaned, point-based spatial data is converted into continuous raster layers for each input variable, which are derived using Inverse Distance Weighting (IDW) method via a <span class="in">`gstat`</span> model and the <span class="in">`terra::interpolate`</span> function. The resulting outputs of mean daily temperature, precipitation, relative humidity, and wind speed are then masked to the AOI and saved for use in the next stages of the analysis.</span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a><span class="co"># Search weather stations</span></span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a>stations_100km <span class="ot">=</span> weathercan<span class="sc">::</span><span class="fu">stations_search</span>(</span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords  =</span> <span class="fu">c</span>(<span class="fl">49.95</span>,<span class="sc">-</span><span class="fl">119.43</span>), </span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval=</span> <span class="st">"day"</span>,</span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist    =</span> <span class="dv">100</span>)</span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse by station</span></span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a>stations_ids_unique <span class="ot">&lt;-</span> stations_100km <span class="sc">|&gt;</span></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(station_id) <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Download data for all selected stations</span></span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a>climate_tbl <span class="ot">&lt;-</span> weathercan<span class="sc">::</span><span class="fu">weather_dl</span>(</span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a>  <span class="at">station_ids =</span> stations_ids_unique,</span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="st">"2021-06-01"</span>,</span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a>  <span class="at">end =</span> <span class="st">"2021-10-01"</span>,</span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">"hour"</span>) <span class="co"># relative humidity in hourly only</span></span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate by station</span></span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a>aggregated_data <span class="ot">&lt;-</span> climate_tbl <span class="sc">|&gt;</span></span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(station_id, lat, lon) <span class="sc">|&gt;</span></span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_temp =</span> <span class="fu">mean</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_prec =</span> <span class="fu">mean</span>(prec_amt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_rh   =</span> <span class="fu">mean</span>(rel_hum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_ws   =</span> <span class="fu">mean</span>(wind_spd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to spatial and filter missing stations</span></span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a>climate_sf <span class="ot">&lt;-</span> aggregated_data <span class="sc">|&gt;</span></span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.nan</span>(mean_temp),</span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.nan</span>(mean_prec),</span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.nan</span>(mean_rh),</span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.nan</span>(mean_ws)</span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(</span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>),</span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a>    <span class="at">crs =</span> <span class="dv">4326</span></span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-224"><a href="#cb6-224" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="st">"EPSG:3857"</span>)</span>
<span id="cb6-225"><a href="#cb6-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive raster template to interpolate on top of</span></span>
<span id="cb6-227"><a href="#cb6-227" aria-hidden="true" tabindex="-1"></a>raster_template <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"../assets/TIF/elevation.tif"</span>)</span>
<span id="cb6-228"><a href="#cb6-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-229"><a href="#cb6-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive function to handle `sf` weather station data</span></span>
<span id="cb6-230"><a href="#cb6-230" aria-hidden="true" tabindex="-1"></a>interpolate_stations <span class="ot">&lt;-</span> <span class="cf">function</span>(model, x, crs, ...) {</span>
<span id="cb6-231"><a href="#cb6-231" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(x, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="at">crs =</span> crs)</span>
<span id="cb6-232"><a href="#cb6-232" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, v, ...)</span>
<span id="cb6-233"><a href="#cb6-233" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>(p)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb6-234"><a href="#cb6-234" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-235"><a href="#cb6-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-236"><a href="#cb6-236" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Inverse Distance Weighting models using gstat.pkg</span></span>
<span id="cb6-237"><a href="#cb6-237" aria-hidden="true" tabindex="-1"></a>temp_idw <span class="ot">&lt;-</span> <span class="fu">gstat</span>(</span>
<span id="cb6-238"><a href="#cb6-238" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> mean_temp <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb6-239"><a href="#cb6-239" aria-hidden="true" tabindex="-1"></a>  <span class="at">locations =</span> climate_sf,</span>
<span id="cb6-240"><a href="#cb6-240" aria-hidden="true" tabindex="-1"></a>  <span class="at">nmax =</span> <span class="dv">8</span>, </span>
<span id="cb6-241"><a href="#cb6-241" aria-hidden="true" tabindex="-1"></a>  <span class="at">set =</span> <span class="fu">list</span>(<span class="at">idp =</span> <span class="fl">2.0</span>) </span>
<span id="cb6-242"><a href="#cb6-242" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-243"><a href="#cb6-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-244"><a href="#cb6-244" aria-hidden="true" tabindex="-1"></a>prec_idw <span class="ot">&lt;-</span> <span class="fu">gstat</span>(</span>
<span id="cb6-245"><a href="#cb6-245" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> mean_prec <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb6-246"><a href="#cb6-246" aria-hidden="true" tabindex="-1"></a>  <span class="at">locations =</span> climate_sf,</span>
<span id="cb6-247"><a href="#cb6-247" aria-hidden="true" tabindex="-1"></a>  <span class="at">nmax =</span> <span class="dv">8</span>, </span>
<span id="cb6-248"><a href="#cb6-248" aria-hidden="true" tabindex="-1"></a>  <span class="at">set =</span> <span class="fu">list</span>(<span class="at">idp =</span> <span class="fl">2.0</span>) </span>
<span id="cb6-249"><a href="#cb6-249" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-250"><a href="#cb6-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-251"><a href="#cb6-251" aria-hidden="true" tabindex="-1"></a>rh_idw <span class="ot">&lt;-</span> <span class="fu">gstat</span>(</span>
<span id="cb6-252"><a href="#cb6-252" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> mean_rh <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb6-253"><a href="#cb6-253" aria-hidden="true" tabindex="-1"></a>  <span class="at">locations =</span> climate_sf,</span>
<span id="cb6-254"><a href="#cb6-254" aria-hidden="true" tabindex="-1"></a>  <span class="at">nmax =</span> <span class="dv">8</span>, </span>
<span id="cb6-255"><a href="#cb6-255" aria-hidden="true" tabindex="-1"></a>  <span class="at">set =</span> <span class="fu">list</span>(<span class="at">idp =</span> <span class="fl">2.0</span>) </span>
<span id="cb6-256"><a href="#cb6-256" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-257"><a href="#cb6-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-258"><a href="#cb6-258" aria-hidden="true" tabindex="-1"></a>ws_idw <span class="ot">&lt;-</span> <span class="fu">gstat</span>(</span>
<span id="cb6-259"><a href="#cb6-259" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> mean_ws <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb6-260"><a href="#cb6-260" aria-hidden="true" tabindex="-1"></a>  <span class="at">locations =</span> climate_sf,</span>
<span id="cb6-261"><a href="#cb6-261" aria-hidden="true" tabindex="-1"></a>  <span class="at">nmax =</span> <span class="dv">8</span>, </span>
<span id="cb6-262"><a href="#cb6-262" aria-hidden="true" tabindex="-1"></a>  <span class="at">set =</span> <span class="fu">list</span>(<span class="at">idp =</span> <span class="fl">2.0</span>) </span>
<span id="cb6-263"><a href="#cb6-263" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-264"><a href="#cb6-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-265"><a href="#cb6-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-266"><a href="#cb6-266" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatially interpolate using terra.pkg</span></span>
<span id="cb6-267"><a href="#cb6-267" aria-hidden="true" tabindex="-1"></a>temp_rast <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">interpolate</span>(</span>
<span id="cb6-268"><a href="#cb6-268" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> raster_template,</span>
<span id="cb6-269"><a href="#cb6-269" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> temp_idw,</span>
<span id="cb6-270"><a href="#cb6-270" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> interpolate_stations,</span>
<span id="cb6-271"><a href="#cb6-271" aria-hidden="true" tabindex="-1"></a>  <span class="at">crs =</span> <span class="st">"EPSG:3857"</span>,</span>
<span id="cb6-272"><a href="#cb6-272" aria-hidden="true" tabindex="-1"></a>  <span class="at">debug.level =</span> <span class="dv">0</span></span>
<span id="cb6-273"><a href="#cb6-273" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-274"><a href="#cb6-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-275"><a href="#cb6-275" aria-hidden="true" tabindex="-1"></a>prec_rast <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">interpolate</span>(</span>
<span id="cb6-276"><a href="#cb6-276" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> raster_template,</span>
<span id="cb6-277"><a href="#cb6-277" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> prec_idw,</span>
<span id="cb6-278"><a href="#cb6-278" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> interpolate_stations,</span>
<span id="cb6-279"><a href="#cb6-279" aria-hidden="true" tabindex="-1"></a>  <span class="at">crs =</span> <span class="st">"EPSG:3857"</span>,</span>
<span id="cb6-280"><a href="#cb6-280" aria-hidden="true" tabindex="-1"></a>  <span class="at">debug.level =</span> <span class="dv">0</span></span>
<span id="cb6-281"><a href="#cb6-281" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-282"><a href="#cb6-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-283"><a href="#cb6-283" aria-hidden="true" tabindex="-1"></a>rh_rast <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">interpolate</span>(</span>
<span id="cb6-284"><a href="#cb6-284" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> raster_template,</span>
<span id="cb6-285"><a href="#cb6-285" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> rh_idw,</span>
<span id="cb6-286"><a href="#cb6-286" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> interpolate_stations,</span>
<span id="cb6-287"><a href="#cb6-287" aria-hidden="true" tabindex="-1"></a>  <span class="at">crs =</span> <span class="st">"EPSG:3857"</span>,</span>
<span id="cb6-288"><a href="#cb6-288" aria-hidden="true" tabindex="-1"></a>  <span class="at">debug.level =</span> <span class="dv">0</span></span>
<span id="cb6-289"><a href="#cb6-289" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-290"><a href="#cb6-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-291"><a href="#cb6-291" aria-hidden="true" tabindex="-1"></a>ws_rast <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">interpolate</span>(</span>
<span id="cb6-292"><a href="#cb6-292" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> raster_template,</span>
<span id="cb6-293"><a href="#cb6-293" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> ws_idw,</span>
<span id="cb6-294"><a href="#cb6-294" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> interpolate_stations,</span>
<span id="cb6-295"><a href="#cb6-295" aria-hidden="true" tabindex="-1"></a>  <span class="at">crs =</span> <span class="st">"EPSG:3857"</span>,</span>
<span id="cb6-296"><a href="#cb6-296" aria-hidden="true" tabindex="-1"></a>  <span class="at">debug.level =</span> <span class="dv">0</span></span>
<span id="cb6-297"><a href="#cb6-297" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-298"><a href="#cb6-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-299"><a href="#cb6-299" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidy, save, and visualize</span></span>
<span id="cb6-300"><a href="#cb6-300" aria-hidden="true" tabindex="-1"></a>temp    <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">mask</span>(temp_rast, terra<span class="sc">::</span><span class="fu">vect</span>(sf<span class="sc">::</span><span class="fu">st_transform</span>(aoi, <span class="st">"EPSG:3857"</span>)))</span>
<span id="cb6-301"><a href="#cb6-301" aria-hidden="true" tabindex="-1"></a>prec    <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">mask</span>(prec_rast, terra<span class="sc">::</span><span class="fu">vect</span>(sf<span class="sc">::</span><span class="fu">st_transform</span>(aoi, <span class="st">"EPSG:3857"</span>)))</span>
<span id="cb6-302"><a href="#cb6-302" aria-hidden="true" tabindex="-1"></a>rh      <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">mask</span>(rh_rast, terra<span class="sc">::</span><span class="fu">vect</span>(sf<span class="sc">::</span><span class="fu">st_transform</span>(aoi, <span class="st">"EPSG:3857"</span>)))</span>
<span id="cb6-303"><a href="#cb6-303" aria-hidden="true" tabindex="-1"></a>ws      <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">mask</span>(ws_rast, terra<span class="sc">::</span><span class="fu">vect</span>(sf<span class="sc">::</span><span class="fu">st_transform</span>(aoi, <span class="st">"EPSG:3857"</span>)))</span>
<span id="cb6-304"><a href="#cb6-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-305"><a href="#cb6-305" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">writeRaster</span>(temp, <span class="st">"../assets/TIF/temp.tif"</span>, <span class="at">overwrite=</span>T)</span>
<span id="cb6-306"><a href="#cb6-306" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">writeRaster</span>(prec, <span class="st">"../assets/TIF/prec.tif"</span>, <span class="at">overwrite=</span>T)</span>
<span id="cb6-307"><a href="#cb6-307" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">writeRaster</span>(rh, <span class="st">"../assets/TIF/rh.tif"</span>, <span class="at">overwrite=</span>T)</span>
<span id="cb6-308"><a href="#cb6-308" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">writeRaster</span>(ws, <span class="st">"../assets/TIF/ws.tif"</span>, <span class="at">overwrite=</span>T)</span>
<span id="cb6-309"><a href="#cb6-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-310"><a href="#cb6-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-311"><a href="#cb6-311" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Render Maps</span></span>
<span id="cb6-312"><a href="#cb6-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-315"><a href="#cb6-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-316"><a href="#cb6-316" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb6-317"><a href="#cb6-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-318"><a href="#cb6-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-319"><a href="#cb6-319" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb6-320"><a href="#cb6-320" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb6-321"><a href="#cb6-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb6-322"><a href="#cb6-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-323"><a href="#cb6-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-324"><a href="#cb6-324" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb6-325"><a href="#cb6-325" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(temp)<span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style=</span> <span class="st">"cont"</span>, </span>
<span id="cb6-326"><a href="#cb6-326" aria-hidden="true" tabindex="-1"></a>  <span class="at">title=</span><span class="st">"Mean Daily Temperature (°C 2m AGL)"</span>, <span class="at">palette=</span><span class="st">"Oranges"</span>)<span class="sc">+</span></span>
<span id="cb6-327"><a href="#cb6-327" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_shape</span>(aoi)<span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">"purple"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-328"><a href="#cb6-328" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_compass</span>(<span class="at">color.dark=</span><span class="st">"gray60"</span>,<span class="at">text.color=</span><span class="st">"gray60"</span>,<span class="at">position=</span><span class="fu">c</span>(<span class="st">"RIGHT"</span>,<span class="st">"top"</span>))<span class="sc">+</span></span>
<span id="cb6-329"><a href="#cb6-329" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_graticules</span>(<span class="at">lines=</span>T,<span class="at">labels.rot=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">90</span>),<span class="at">lwd=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb6-330"><a href="#cb6-330" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_scale_bar</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>), <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span>), <span class="at">text.size =</span> .<span class="dv">5</span>) <span class="ot">-&gt;</span> tm1</span>
<span id="cb6-331"><a href="#cb6-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-332"><a href="#cb6-332" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(prec)<span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style=</span> <span class="st">"cont"</span>, </span>
<span id="cb6-333"><a href="#cb6-333" aria-hidden="true" tabindex="-1"></a>  <span class="at">title=</span><span class="st">"Mean Daily Precipitation (mm^3/day)"</span>, <span class="at">palette=</span><span class="st">"Oranges"</span>) <span class="sc">+</span></span>
<span id="cb6-334"><a href="#cb6-334" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_shape</span>(aoi)<span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">"purple"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-335"><a href="#cb6-335" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_compass</span>(<span class="at">color.dark=</span><span class="st">"gray60"</span>,<span class="at">text.color=</span><span class="st">"gray60"</span>,<span class="at">position=</span><span class="fu">c</span>(<span class="st">"RIGHT"</span>,<span class="st">"top"</span>))<span class="sc">+</span></span>
<span id="cb6-336"><a href="#cb6-336" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_graticules</span>(<span class="at">lines=</span>T,<span class="at">labels.rot=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">90</span>),<span class="at">lwd=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb6-337"><a href="#cb6-337" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_scale_bar</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>), <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span>), <span class="at">text.size =</span> .<span class="dv">5</span>) <span class="ot">-&gt;</span> tm2</span>
<span id="cb6-338"><a href="#cb6-338" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-339"><a href="#cb6-339" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(rh)<span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style=</span> <span class="st">"cont"</span>, </span>
<span id="cb6-340"><a href="#cb6-340" aria-hidden="true" tabindex="-1"></a>  <span class="at">title=</span><span class="st">"Relative Humidity (NCDC 2m AGL)"</span>, <span class="at">palette=</span><span class="st">"Oranges"</span>) <span class="sc">+</span></span>
<span id="cb6-341"><a href="#cb6-341" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_shape</span>(aoi)<span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">"purple"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-342"><a href="#cb6-342" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_compass</span>(<span class="at">color.dark=</span><span class="st">"gray60"</span>,<span class="at">text.color=</span><span class="st">"gray60"</span>,<span class="at">position=</span><span class="fu">c</span>(<span class="st">"RIGHT"</span>,<span class="st">"top"</span>))<span class="sc">+</span></span>
<span id="cb6-343"><a href="#cb6-343" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_graticules</span>(<span class="at">lines=</span>T,<span class="at">labels.rot=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">90</span>),<span class="at">lwd=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb6-344"><a href="#cb6-344" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_scale_bar</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>), <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span>), <span class="at">text.size =</span> .<span class="dv">5</span>) <span class="ot">-&gt;</span> tm3</span>
<span id="cb6-345"><a href="#cb6-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-346"><a href="#cb6-346" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(ws)<span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style=</span> <span class="st">"cont"</span>, </span>
<span id="cb6-347"><a href="#cb6-347" aria-hidden="true" tabindex="-1"></a>  <span class="at">title=</span><span class="st">"Wind Speed (m/s 10m AGL)"</span>, <span class="at">palette=</span><span class="st">"Oranges"</span>) <span class="sc">+</span></span>
<span id="cb6-348"><a href="#cb6-348" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_shape</span>(aoi)<span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">"purple"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-349"><a href="#cb6-349" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_compass</span>(<span class="at">color.dark=</span><span class="st">"gray60"</span>,<span class="at">text.color=</span><span class="st">"gray60"</span>,<span class="at">position=</span><span class="fu">c</span>(<span class="st">"RIGHT"</span>,<span class="st">"top"</span>))<span class="sc">+</span></span>
<span id="cb6-350"><a href="#cb6-350" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_graticules</span>(<span class="at">lines=</span>T,<span class="at">labels.rot=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">90</span>),<span class="at">lwd=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb6-351"><a href="#cb6-351" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_scale_bar</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>), <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span>), <span class="at">text.size =</span> .<span class="dv">5</span>) <span class="ot">-&gt;</span> tm4</span>
<span id="cb6-352"><a href="#cb6-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-353"><a href="#cb6-353" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tmap_arrange</span>(tm1, tm2, tm3, tm4, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb6-354"><a href="#cb6-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-355"><a href="#cb6-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-356"><a href="#cb6-356" aria-hidden="true" tabindex="-1"></a>+:-----------------------------------------------------------------------------------------------------------------------:+:---------------------------------------------------------------------------------------------------------------------:+</span>
<span id="cb6-357"><a href="#cb6-357" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="al">![](https://raw.githubusercontent.com/seamusrobertmurphy/forest-fire-risk-cffdrs/main/assets/PNG/temp.png)</span>{width="345"} <span class="pp">|</span> <span class="al">![](https://raw.githubusercontent.com/seamusrobertmurphy/forest-fire-risk-cffdrs/main/assets/PNG/rh.png)</span>{width="345"} <span class="pp">|</span></span>
<span id="cb6-358"><a href="#cb6-358" aria-hidden="true" tabindex="-1"></a>+-------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb6-359"><a href="#cb6-359" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="al">![](https://raw.githubusercontent.com/seamusrobertmurphy/forest-fire-risk-cffdrs/main/assets/PNG/prec.png)</span>{width="345"} <span class="pp">|</span> <span class="al">![](https://raw.githubusercontent.com/seamusrobertmurphy/forest-fire-risk-cffdrs/main/assets/PNG/ws.png)</span>{width="345"} <span class="pp">|</span></span>
<span id="cb6-360"><a href="#cb6-360" aria-hidden="true" tabindex="-1"></a>+-------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------+</span>
<span id="cb6-361"><a href="#cb6-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-362"><a href="#cb6-362" aria-hidden="true" tabindex="-1"></a><span class="fu">### Runtime Log</span></span>
<span id="cb6-363"><a href="#cb6-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-364"><a href="#cb6-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r session-info}</span></span>
<span id="cb6-365"><a href="#cb6-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb6-366"><a href="#cb6-366" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb6-367"><a href="#cb6-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-368"><a href="#cb6-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-369"><a href="#cb6-369" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>Breach-fill algorithm by Lindsay's paper (2016)</span>
<span id="cb6-370"><a href="#cb6-370" aria-hidden="true" tabindex="-1"></a>    "Efficient hybrid breaching-filling sink removal methods</span>
<span id="cb6-371"><a href="#cb6-371" aria-hidden="true" tabindex="-1"></a>    for flow path enforcement in digital elevation models:</span>
<span id="cb6-372"><a href="#cb6-372" aria-hidden="true" tabindex="-1"></a>    Efficient Hybrid Sink Removal Methods for Flow Path</span>
<span id="cb6-373"><a href="#cb6-373" aria-hidden="true" tabindex="-1"></a>    Enforcement: (Hydrological Processes 30, 846–857.</span>
<span id="cb6-374"><a href="#cb6-374" aria-hidden="true" tabindex="-1"></a>    doi:10.1002/hyp.10648) -<span class="sc">\&gt;</span></span>
<span id="cb6-375"><a href="#cb6-375" aria-hidden="true" tabindex="-1"></a>    <span class="in">`flowdem::comp_breach_lindsay2016(dem)`</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://github.com/seamusrobertmurphy/lidar-forestry">Source</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/seamusrobertmurphy/map-templates/edit/main/05-climate/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/seamusrobertmurphy/map-templates/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p><a href="https://linkedin.com/in/seamusrobertmurphy">LinkedIn</a> | <a href="https://drive.google.com/uc?export=download&amp;id=13YLhsRCAMMHQw-jd2SJdaRJH9udBGytP">Resume</a> | <a href="https://scholar.google.com/citations?hl=en&amp;user=jDGq9I4AAAAJ">Scholar</a></p>
</div>
  </div>
</footer>


</body></html>